---
layout: post
title: 高斯消元
date: 2018-06-24
category: Learning
tag: 高斯消元
mathjax: true
---
* content
{:toc}
# 前言

　　虽然道理我都懂，但是我总是写混......隔三差五地打高斯消元，与当时记不清Tarjan的各个分支的感觉是一样迷茫。



# 定义和概念

　　**矩阵**：一个$n*n$的矩阵。

　　**扩展矩阵**：一个$n*(n+1)$的矩阵。矩阵的最右端多了一列系数，常用于表示解方程组时的常数项。

　　**主元**：用于逐步消元的未知数$x$，一般有$n$个。枚举每一个主元时，为了保证精度，我们从所有方程中挑选该主元系数绝对值最大的一条方程作为当前方程，用来消去其他方程中的该主元。如果是取模意义下，挑选主元系数非0的一条方程即可。

　　**自由元**：如果枚举到某个未知数时，余下的所有方程中该未知数的系数都为0，那么此变量是一个自由元。自由元的存在，说明有一些方程是线性相关的（无用的）。自由元的个数，等于消元完成后全0方程的条数。只要枚举自由元的取值，就能确定其他所有未知数的取值。



# 线性方程组求解

　　我们使用扩展矩阵表示线性方程组。

　　我们的目的是使用高斯消元将矩阵消成上三角矩阵。此时，最后一个未知数可由最后一条方程直接得出，然后一直回代到倒数第二条方程，解出倒数第二个未知数......一直回代即可解出所有未知数。

　　伪代码：

```c++
void gaussian(){
    for(int i=1;i<=n;i++){
        int best=满足a[best][i]在第i列的绝对值最大（实数）或满足a[best][i]!=0（模意义下）;
        交换a[i],a[best];
        for(int j=i+1;j<=n;j++)
            用第i行消去第j行的a[j][i];
    }
    for(int i=n;i>=1;i--){
        for(int j=i+1;j<=n;j++) a[i][n+1]-=a[i][j]*x[j];
        x[i]=a[i][n+1];
    }
}
```

　　无解仅可能在方程条数大于未知数个数时出现。消元完成时，矩阵下方会有一部分**系数全0**方程，如果此时这些方程的常数项不为0，则整体无解。否则说明出现了线性相关方程，方程依然不相互冲突。

​	

　　咕咕咕