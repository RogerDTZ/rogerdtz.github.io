---
layout: post
mathjax: true
title: 【清华集训2016】你的生命已如风中残烛
date: 2018-11-13-20:01:00
tag: [转化,结论题,数论---组合数学,数论---第一类斯特林数]
category: 清华集训
---
* content
{:toc}
# Description

　　有$m+1$张牌，最后一张牌固定放在牌堆底部，其余$m$张牌按随机顺序压在上方，共有$m!$种情况

　　这$m$张牌中，有$n$张牌是特殊牌，每一张牌有一个数字$a_i$，表示你可以消耗掉这张牌并从牌堆顶部连续抽取$a_i$张牌；其余$m-n$张是杂牌，没有任何作用

　　开始时，你可以抽取牌堆顶部的第一张牌，然后开始你的操作

　　我们保证$\sum_{i=1}^n a_i=m$，显然此时如果牌的顺序得当，你可以顺利拿走所有$m+1$张牌

　　问总共有多少种情况使得你可以拿走所有牌



# Solution

　　首先做一些模型的转化。由于这个问题与加油和耗油的过程类似，我们把这$m+1$张牌各记一个权值量化为行车问题：设特殊牌权值为$a_i-1$，杂牌权值为$-1$，则一个局面为合法，当且仅当前$m$个前缀和非负；至于第$m+1$个前缀和，其显然是定值，没有考虑的必要

　　鬼知道为什么会想到轮换去。考虑这$m+1$个元素的$S_1(m+1,1)=m!$个轮换，对于每一个轮换$L$，我们从任意一个位置先断开这样看，求一遍前缀和$A$；同时我们发现，如果将$L$在**前缀和最小的位置中最靠后的那个位置$x$**之后断开，以之后的那个位置$x+1$作为牌堆顶，以这个位置作为牌堆底，这样必定是合法的。首先，前缀和最小的位置$x$一定是$-1$；其次，由于$x$为最靠后的前缀和最小的位置，这意味着从$x+1$开始一直到当前这样看的尾部，前缀和都非负；再者，由于所有元素之和为$-1$，因此$x+1$开始到尾部的所有元素之和恰好等于$-1-A_x$，这意味着如果按刚才说的方式划分，从头开始到$x-1$的所有前缀和都将补上$-1-A_x$，全部可以达到非负状态。而$x$是最后一个元素，不需要考虑，前缀和走到这里一定等于$-1$

　　所以$m!$个轮换的每一个都唯一对应了一种合法方案

　　但是其实这样有重复。我们断开时找的是$-1$来断开，而依据题意，最后一张牌应该固定成为最后一个元素，而此时最后一张牌在每一个$-1$的位置时我们却都假定断开的那个$-1$就是最后一个元素，算重了。我们除掉出现次数即牌堆内$-1$的个数$m-n+1$即可

　　所以答案为

$$
\frac{m!}{n-m+1}
$$



　

# Code

```
#include <cstdio>
using namespace std;
const int MOD=998244353;
int n,m;
void readData(){
	scanf("%d",&n);
	int x;
	for(int i=1;i<=n;i++){
		scanf("%d",&x);
		m+=x;
	}
}
void solve(){
	int ans=1;
	for(int i=1;i<=m;i++)
		if(i!=m-n+1)
			ans=1ll*ans*i%MOD;
	printf("%d\n",ans>=0?ans:ans+MOD);
}
int main(){
	readData();
	solve();
	return 0;
}
```

