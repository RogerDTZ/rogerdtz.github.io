---
title: Bluestein算法：任意长度FFT
mathjax: true
date: 2019-06-25 09:46:50
tags: [FFT]
categories: [Learning]
---

# 任务描述

给定两个次数界为$n$的多项式$A(x)$和$B(x)$

求$A(x)B(x) \bmod x^n$

<!-- more -->

# 使用情况

**FFT本身就是循环卷积**

平时使用多项式乘法时，为了不被循环干扰，我们可以直接扩大到两倍长度进行处理

但如果要求的是循环卷积，且卷积长度不是$2$的整数次幂时，就要使用任意长度FFT了

# Bluestein 算法

## DFT

考虑DFT变换的式子：

$$
\begin{aligned}
A_k
&= \sum_{j=0}^{n-1} a_j (\omega_n^k)^j \\
&= \sum_{j=0}^{n-1} a_j \omega_n^{kj} \\
\end {aligned}
$$

考虑展开$kj$：

$$
kj= {k+j \choose 2}-{k \choose 2}-{j \choose 2}
$$

代入得：
$$
\begin{aligned}
A_k
&= \sum_{j=0}^{n-1} a_j \omega_n^{ {k+j \choose 2}-{k \choose 2}-{j \choose 2} } \\
&= \omega_n^{-{k \choose 2} } \sum_{j=0}^{n-1} a_j \omega_n^{-{j \choose 2} } \times \omega_n^{ {k+j \choose 2} } \\
\end {aligned}
$$
令$X_j=a_j \omega_n^{-{j \choose 2} }$，$Y_j=\omega_n^{j \choose 2} $，则：

$$
\begin{aligned}
A_k
&= \omega_n^{-{k \choose 2} } \sum_{j=0}^{n-1} X_j  Y_{k+j} \\
\end{aligned}
$$

使用一个普通FFT计算后面的部分即可

注意到上面$\omega_n$的幂次都是整数，且对$n$取模，所以处理起来没有任何问题

时间复杂度$O(n \log n)$

## IDFT

过程相似：

$$
\begin{aligned}
a_k
&= \frac 1n \sum_{j=0}^{n-1} A_j (\omega_n^{-k})^j \\
&= \frac 1n \sum_{j=0}^{n-1} A_j \omega_n^{-kj} \\
&= \frac 1n \sum_{j=0}^{n-1} A_j \omega_n^{ {k \choose 2}+{j \choose 2}-{k+j \choose 2} } \\
&= \frac {\omega_n^{k \choose 2} }{n} \sum_{j=0}^{n-1} A_j \omega_n^{j \choose 2} \times \omega_n^{-{k+j \choose 2} } \\

\end {aligned}
$$

令$X_j = A_j \omega_n^{j \choose 2}$，$Y_j = \omega_n^{-{j \choose 2}}$，则：

$$
a_k = \frac {\omega_n^{k \choose 2} }{n} \sum_{j=0}^{n-1} X_j Y_{k+j} \\
$$

